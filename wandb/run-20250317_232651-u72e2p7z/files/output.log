                                                                                                                                   /home/yjw5427/miniconda3/envs/trans/lib/python3.10/site-packages/trl/trainer/dpo_trainer.py:1073: UserWarning: compute_loss is only implemented for DPODataCollatorWithPadding, and you passed a datacollator that is different than DPODataCollatorWithPadding - you might see unexpected behavior. Alternatively, you can implement your own prediction_step method if you are using a custom data collator
  warnings.warn(                                                                                           | 0/375 [00:00<?, ?it/s]
[WARNING|logging.py:328] 2025-03-17 23:26:58,442 >> Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
[WARNING|modeling_utils.py:1279] 2025-03-17 23:26:58,922 >> Could not estimate the number of tokens of the input, floating-point operations will not be computed





















































































































































































































































































































































































Traceback (most recent call last):███████████████████████████████████████████████████████████████| 375/375 [15:04<00:00,  2.52s/it]
  File "/data/home/yjw5427/translora/fed_distill_dpo.py", line 841, in <module>
    main()
  File "/data/home/yjw5427/translora/fed_distill_dpo.py", line 805, in main
    with open(outfolder + file_name, 'wb') as f:
FileNotFoundError: [Errno 2] No such file or directory: '/data/yujia_wang/translora/results/dpo_llama3_mathinstruct_fedavg_rounds[1]_llr[1e-06]_li[3.0]_iid[iid]_nuser[1]_suser[1]_dpo.pkl'
Traceback (most recent call last):
  File "/data/home/yjw5427/translora/fed_distill_dpo.py", line 841, in <module>
    main()
  File "/data/home/yjw5427/translora/fed_distill_dpo.py", line 805, in main
    with open(outfolder + file_name, 'wb') as f:
FileNotFoundError: [Errno 2] No such file or directory: '/data/yujia_wang/translora/results/dpo_llama3_mathinstruct_fedavg_rounds[1]_llr[1e-06]_li[3.0]_iid[iid]_nuser[1]_suser[1]_dpo.pkl'
{'train_runtime': 911.4302, 'train_samples_per_second': 1.646, 'train_steps_per_second': 0.411, 'train_loss': 0.6905802408854167, 'epoch': 3.0}
***** train metrics *****
  epoch                    =        3.0
  total_flos               =        0GF
  train_loss               =     0.6906
  train_runtime            = 0:15:11.43
  train_samples            =          5
  train_samples_per_second =      1.646
  train_steps_per_second   =      0.411