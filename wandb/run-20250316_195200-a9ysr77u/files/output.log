

100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:03<00:00,  3.14s/it]
{'train_runtime': 9.349, 'train_samples_per_second': 0.107, 'train_steps_per_second': 0.107, 'train_loss': 0.2632886469364166, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  total_flos               =    43423GF
  train_loss               =     0.2633
  train_runtime            = 0:00:09.34
  train_samples            =          1
  train_samples_per_second =      0.107
  train_steps_per_second   =      0.107
0
1.2e-06
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.11it/s]
{'train_runtime': 0.9287, 'train_samples_per_second': 1.077, 'train_steps_per_second': 1.077, 'train_loss': 0.1899351179599762, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  total_flos               =    43423GF
  train_loss               =     0.1899
  train_runtime            = 0:00:00.92
  train_samples            =         11
  train_samples_per_second =      1.077
  train_steps_per_second   =      1.077
0
1.2e-06
  0%|                                                                                                 | 0/1 [00:00<?, ?it/s]
{'train_runtime': 0.9068, 'train_samples_per_second': 1.103, 'train_steps_per_second': 1.103, 'train_loss': 0.1535317599773407, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  total_flos               =    43423GF
  train_loss               =     0.1535
  train_runtime            = 0:00:00.90
  train_samples            =          3
  train_samples_per_second =      1.103
  train_steps_per_second   =      1.103
0
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.16it/s]
  0%|                                                                                                 | 0/1 [00:00<?, ?it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.35it/s]
  0%|                                                                                                 | 0/1 [00:00<?, ?it/s]
***** train metrics *****
  epoch                    =        1.0
  total_flos               =     5046GF
  train_loss               =     0.5392
  train_runtime            = 0:00:00.77
  train_samples            =          1
  train_samples_per_second =      1.291
  train_steps_per_second   =      1.291
0
1.2e-06
Traceback (most recent call last):████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.17it/s]
  File "/data/home/yjw5427/translora/fed_lora.py", line 915, in <module>
    main()
  File "/data/home/yjw5427/translora/fed_lora.py", line 846, in main
    res = generate_text(prompt)
  File "/data/home/yjw5427/translora/fed_lora.py", line 830, in generate_text
    outputs = model.generate(
TypeError: PeftModelForCausalLM.generate() takes 1 positional argument but 2 were given
***** train metrics *****
  epoch                    =        1.0
  total_flos               =    43423GF
  train_loss               =     0.2661
  train_runtime            = 0:00:00.88
  train_samples            =          3
  train_samples_per_second =      1.127
  train_steps_per_second   =      1.127