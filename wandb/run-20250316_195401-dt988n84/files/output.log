100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.09s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.09s/it]
{'train_runtime': 7.0637, 'train_samples_per_second': 0.142, 'train_steps_per_second': 0.142, 'train_loss': 0.2632886469364166, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  total_flos               =    43423GF
  train_loss               =     0.2633
  train_runtime            = 0:00:07.06
  train_samples            =          1
  train_samples_per_second =      0.142
  train_steps_per_second   =      0.142
0
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.60it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.61it/s]
  0%|                                                                                                 | 0/1 [00:00<?, ?it/s]
{'train_runtime': 0.6418, 'train_samples_per_second': 1.558, 'train_steps_per_second': 1.558, 'train_loss': 0.1899351179599762, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  total_flos               =    43423GF
  train_loss               =     0.1899
  train_runtime            = 0:00:00.64
  train_samples            =         11
  train_samples_per_second =      1.558
  train_steps_per_second   =      1.558
0
1.2e-06
{'train_runtime': 0.6288, 'train_samples_per_second': 1.59, 'train_steps_per_second': 1.59, 'train_loss': 0.1535317599773407, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  total_flos               =    43423GF
  train_loss               =     0.1535
  train_runtime            = 0:00:00.62
  train_samples            =          3
  train_samples_per_second =       1.59
  train_steps_per_second   =       1.59
0
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.65it/s]
  0%|                                                                                                 | 0/1 [00:00<?, ?it/s]
{'train_runtime': 0.5668, 'train_samples_per_second': 1.764, 'train_steps_per_second': 1.764, 'train_loss': 0.539245069026947, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  total_flos               =     5046GF
  train_loss               =     0.5392
  train_runtime            = 0:00:00.56
  train_samples            =          1
  train_samples_per_second =      1.764
  train_steps_per_second   =      1.764
0
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.87it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.26it/s]
{'train_runtime': 0.856, 'train_samples_per_second': 1.168, 'train_steps_per_second': 1.168, 'train_loss': 0.2660704255104065, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  total_flos               =    43423GF
  train_loss               =     0.2661
  train_runtime            = 0:00:00.85
  train_samples            =          3
  train_samples_per_second =      1.168
[WARNING|logging.py:328] 2025-03-16 19:54:14,677 >> The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
[WARNING|logging.py:328] 2025-03-16 19:54:15,085 >> Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
Traceback (most recent call last):
  File "/data/home/yjw5427/translora/fed_lora.py", line 915, in <module>
    main()
  File "/data/home/yjw5427/translora/fed_lora.py", line 879, in main
    with open(outfolder + file_name, 'wb') as f:
FileNotFoundError: [Errno 2] No such file or directory: '/data/yujia_wang/translora/results/lora_llama3_mathinstruct_fedavg_rounds[20]_llr[3e-06]_li[1.0]_iid[noniid]_nuser[10]_suser[5]_lora20.pkl'
name[Giraffe], eatType[pub], food[French], area[city centre], familyFriendly[no], near[Raja Indian Cuisine]
['name[Giraffe], eatType[pub], food[French], area[city centre], familyFriendly[no], near[Raja Indian Cuisine]']