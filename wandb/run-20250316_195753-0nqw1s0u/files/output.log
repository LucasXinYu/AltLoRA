100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.22s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  1.21s/it]
{'train_runtime': 7.1125, 'train_samples_per_second': 0.141, 'train_steps_per_second': 0.141, 'train_loss': 0.2632886469364166, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  total_flos               =    43423GF
  train_loss               =     0.2633
  train_runtime            = 0:00:07.11
  train_samples            =          1
  train_samples_per_second =      0.141
  train_steps_per_second   =      0.141
0
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.30it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.31it/s]
{'train_runtime': 0.793, 'train_samples_per_second': 1.261, 'train_steps_per_second': 1.261, 'train_loss': 0.1899351179599762, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  total_flos               =    43423GF
  train_loss               =     0.1899
  train_runtime            = 0:00:00.79
  train_samples            =         11
  train_samples_per_second =      1.261
  train_steps_per_second   =      1.261
0
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.22it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.22it/s]
{'train_runtime': 0.8497, 'train_samples_per_second': 1.177, 'train_steps_per_second': 1.177, 'train_loss': 0.1535317599773407, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  total_flos               =    43423GF
  train_loss               =     0.1535
  train_runtime            = 0:00:00.84
  train_samples            =          3
  train_samples_per_second =      1.177
  train_steps_per_second   =      1.177
0
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.52it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.54it/s]
{'train_runtime': 0.6829, 'train_samples_per_second': 1.464, 'train_steps_per_second': 1.464, 'train_loss': 0.539245069026947, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  total_flos               =     5046GF
  train_loss               =     0.5392
  train_runtime            = 0:00:00.68
  train_samples            =          1
  train_samples_per_second =      1.464
  train_steps_per_second   =      1.464
0
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.26it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.28it/s]
{'train_runtime': 0.8148, 'train_samples_per_second': 1.227, 'train_steps_per_second': 1.227, 'train_loss': 0.2660704255104065, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  total_flos               =    43423GF
  train_loss               =     0.2661
  train_runtime            = 0:00:00.81
  train_samples            =          3
  train_samples_per_second =      1.227
  train_steps_per_second   =      1.227
name[Giraffe], eatType[pub], food[French], area[city centre], familyFriendly[no], near[Raja Indian Cuisine]
['name[Giraffe], eatType[pub], food[French], area[city centre], familyFriendly[no], near[Raja Indian Cuisine]']
This round clients: [0, 1, 2, 3, 4]
0
[WARNING|logging.py:328] 2025-03-16 19:58:08,376 >> The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
[WARNING|logging.py:328] 2025-03-16 19:58:08,608 >> Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
  0%|                                                                                                 | 0/1 [00:00<?, ?it/s]
{'train_runtime': 0.8122, 'train_samples_per_second': 1.231, 'train_steps_per_second': 1.231, 'train_loss': 0.26305103302001953, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  total_flos               =    43423GF
  train_loss               =     0.2631
  train_runtime            = 0:00:00.81
  train_samples            =          1
  train_samples_per_second =      1.231
  train_steps_per_second   =      1.231
0
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.28it/s]
  0%|                                                                                                 | 0/1 [00:00<?, ?it/s]
{'train_runtime': 0.8425, 'train_samples_per_second': 1.187, 'train_steps_per_second': 1.187, 'train_loss': 0.19935506582260132, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  total_flos               =    43423GF
  train_loss               =     0.1994
  train_runtime            = 0:00:00.84
  train_samples            =         11
  train_samples_per_second =      1.187
  train_steps_per_second   =      1.187
0
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.26it/s]
  0%|                                                                                                 | 0/1 [00:00<?, ?it/s]
{'train_runtime': 0.7929, 'train_samples_per_second': 1.261, 'train_steps_per_second': 1.261, 'train_loss': 0.3383624255657196, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  total_flos               =    43423GF
  train_loss               =     0.3384
  train_runtime            = 0:00:00.79
  train_samples            =          3
  train_samples_per_second =      1.261
  train_steps_per_second   =      1.261
0
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.31it/s]
  0%|                                                                                                 | 0/1 [00:00<?, ?it/s]
{'train_runtime': 0.6827, 'train_samples_per_second': 1.465, 'train_steps_per_second': 1.465, 'train_loss': 0.5401695966720581, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  total_flos               =     5046GF
  train_loss               =     0.5402
  train_runtime            = 0:00:00.68
  train_samples            =          1
  train_samples_per_second =      1.465
  train_steps_per_second   =      1.465
0
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.27it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.28it/s]
{'train_runtime': 0.8129, 'train_samples_per_second': 1.23, 'train_steps_per_second': 1.23, 'train_loss': 0.14791430532932281, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  total_flos               =    43423GF
  train_loss               =     0.1479
  train_runtime            = 0:00:00.81
  train_samples            =          3
  train_samples_per_second =       1.23
  train_steps_per_second   =       1.23
name[Giraffe], eatType[pub], food[French], area[city centre], familyFriendly[no], near[Raja Indian Cuisine]
['name[Giraffe], eatType[pub], food[French], area[city centre], familyFriendly[no], near[Raja Indian Cuisine]']
This round clients: [0, 1, 2, 3, 4]
0
2.4e-06
  0%|                                                                                                 | 0/1 [00:00<?, ?it/s]
{'train_runtime': 0.8811, 'train_samples_per_second': 1.135, 'train_steps_per_second': 1.135, 'train_loss': 0.26305603981018066, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  total_flos               =    43423GF
  train_loss               =     0.2631
  train_runtime            = 0:00:00.88
  train_samples            =          1
  train_samples_per_second =      1.135

100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.18it/s]
0
2.4e-06
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.19it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.20it/s]
***** train metrics *****
  epoch                    =        1.0
  total_flos               =    43423GF
  train_loss               =     0.1893
  train_runtime            = 0:00:00.86
  train_samples            =         11
  train_samples_per_second =      1.155
  train_steps_per_second   =      1.155
0
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.22it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.23it/s]
{'train_runtime': 0.8612, 'train_samples_per_second': 1.161, 'train_steps_per_second': 1.161, 'train_loss': 0.33851805329322815, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  total_flos               =    43423GF
  train_loss               =     0.3385
  train_runtime            = 0:00:00.86
  train_samples            =          3
  train_samples_per_second =      1.161
  train_steps_per_second   =      1.161
0
100%|█████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.23it/s]Traceback (most recent call last):
  File "/data/home/yjw5427/translora/fed_lora.py", line 915, in <module>                              | 0/1 [00:00<?, ?it/s]
    main()
  File "/data/home/yjw5427/translora/fed_lora.py", line 772, in main
    train_result = trainer.train(resume_from_checkpoint=checkpoint)
  File "/home/yjw5427/miniconda3/envs/trans/lib/python3.10/site-packages/transformers/trainer.py", line 2052, in train
    return inner_training_loop(
  File "/home/yjw5427/miniconda3/envs/trans/lib/python3.10/site-packages/transformers/trainer.py", line 2388, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs)
  File "/home/yjw5427/miniconda3/envs/trans/lib/python3.10/site-packages/transformers/trainer.py", line 3518, in training_step
    self.accelerator.backward(loss, **kwargs)
  File "/home/yjw5427/miniconda3/envs/trans/lib/python3.10/site-packages/accelerate/accelerator.py", line 2241, in backward
    loss.backward(**kwargs)
  File "/home/yjw5427/miniconda3/envs/trans/lib/python3.10/site-packages/torch/_tensor.py", line 492, in backward
    torch.autograd.backward(
  File "/home/yjw5427/miniconda3/envs/trans/lib/python3.10/site-packages/torch/autograd/__init__.py", line 251, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt